# Rime schema settings
# encoding: utf-8

schema:
  schema_id: liuli
  name: ğŸ’Â·ç‰ç’ƒ
  version: v202601202014
  author:
    - å®‡æµ©
    - é˜¿å‰
    - forFudan
    - ç‹ç‰Œé¥¼å¹²
    - è’
  description: |
    ç‰ç’ƒ(ä¸ƒä¸‰é¡¶)ï¼Œæ„ä¸ºâ€œç¾ç‰â€ï¼Œè±¡å¾çº¯å‡€ä¸ç¾å¥½ã€‚Rimeè¾“å…¥æ³•çš„è¿™æ¬¾â€œç‰ç’ƒâ€æ–¹æ¡ˆï¼Œæ—¨åœ¨ä¸ºç”¨æˆ·æä¾›ä¸€ç§æ¸…æ™°ã€ä¼˜é›…ä¸”é«˜æ•ˆçš„ä¸­æ–‡è¾“å…¥ä½“éªŒã€‚
    å®ƒèåˆäº†ç°ä»£è¾“å…¥æ³•çš„å…ˆè¿›æŠ€æœ¯ä¸ä¼ ç»Ÿæ±‰å­—æ–‡åŒ–çš„ç²¾é«“ï¼ŒåŠ›æ±‚åœ¨è¾“å…¥é€Ÿåº¦ä¸å‡†ç¡®æ€§ä¹‹é—´è¾¾åˆ°æœ€ä½³å¹³è¡¡ã€‚
    æ— è®ºæ˜¯æ—¥å¸¸äº¤æµè¿˜æ˜¯ä¸“ä¸šå†™ä½œï¼Œç‰ç’ƒæ–¹æ¡ˆéƒ½èƒ½åŠ©æ‚¨è½»æ¾è¡¨è¾¾æ€æƒ³ï¼Œç•…æ¸¸æ–‡å­—çš„æµ·æ´‹ã€‚  â€”â€”By DeepSeek
  dependencies:
    # é­”ç„¶, ç”¨äºåæŸ¥
    - liuli.moran
    # åŸºç¡€ç è¡¨
    - liuli.base
    # å…¨ç è¯åº“
    - liuli.words
    # ç¬¦è™Ÿç¢¼è¡¨
    - liuli.symbols

switches:
  - options: [ division.off, division.lv1, division.lv2, division.lv3, division.lv4 ]
    states: [ æ³¨è§£å…³, æ³¨è§£ä¸€, æ³¨è§£äºŒ, æ³¨è§£ä¸‰, æ³¨è§£å›› ]
    reset: 0
  - options: [ hwang, sentence, single_char_delay, single_char ]
    states: [ æ™ºèƒ½å»¶è¿Ÿé¡¶, æ•´å¥, äº”ä¸‰é¡¶, ä¸‰å®š ]
    abbrev: [ä¸ƒ, äº”, ä¸‰]
    reset: 0
  - options: [ full.word, full.char, full.off ]
    states: [ å­—è¯åŒå‡º, ç¦å‡ºè¯ç»„, ç¦å‡ºå››ç  ]
    reset: 0
  - name: embeded_cands
    states: [ æ™®é€š, åµŒå…¥ ]
    reset: 1
  - name: completion
    states: [ ç®€æ´, é¢„æµ‹ ]
    reset: 0
  - options: [ charset.all, charset.freqly ]
    states: [ å…¨å­—é›†, å¸¸ç”¨å­— ]
    reset: 0
  - name: emoji
    states: [ ğŸˆš, ğŸˆ¶ ]
    reset: 1
  - name: ivd_map
    states: [ NoIVD, IVD ]
    reset: 0
  - name: ascii_mode
    states: [ æ±‰å­—, è¥¿æ–‡ ]
    reset: 0
  - name: ascii_punct
    states: [ 'ï¼Œã€‚', 'ï¼Œï¼' ]
    reset: 0
  - name: full_shape
    states: [ åŠ, å…¨ ]
    reset: 0

engine:
  processors:
    - lua_processor@*liuli.core_processor@ll
    - ascii_composer
    - recognizer
    - key_binder
    - speller
    - punctuator
    - selector
    - navigator
    - express_editor
  segmentors:
    - ascii_segmentor
    - matcher
    - abc_segmentor
    - punct_segmentor
  translators:
    - punct_translator
    # ç¬¦è™Ÿç¿»è­¯å™¨
    - table_translator@symbols
    # ä¸Šæ¬¡ä¸Šå±å†å²
    - history_translator@history
    # åæŸ¥
    - reverse_lookup_translator@rev_moran
    # ä¸»ç¿»è¯‘å™¨
    - lua_translator@*liuli.core_translator@ll
    - lua_translator@*liuli.stats_3
  filters:
    - simplifier
    - simplifier@emoji
    # å€™é€‰å»é‡
    - uniquifier
    # åæŸ¥æ‹†åˆ†æç¤º
    - simplifier@rev_div
    # æ‹†åˆ†æç¤º
    - simplifier@division.lv1
    - simplifier@division.lv2
    - simplifier@division.lv3
    - simplifier@division.lv4
    - simplifier@ivd_map
    # åµŒå…¥å€™é€‰
    - lua_filter@*liuli.embeded_cands@embeded_cands

speller:
  alphabet: "qwertyuiopasdfghjklzxcvbnm /`|.:"
  initials: "qwertyuiopasdfghjklzxcvbnm/`"
  auto_select: true
  auto_select_unique_candidate: true
  algebra:

# é‡å¤ä¸Šæ¬¡ä¸Šå±
history:
  input: '`'
  size: 1
  initial_quality: 1

# éƒ¨ä»¶æ‹†åˆ†æç¤º
division.lv1:
  __include: rev_div
  option_name: division.lv1
  comment_format:
    - xform/\(([^,]*),([^,]*),([^,]*),([^,]*)\)/($1)/
    - xform/.*\(([^()]*)\)$/($1)/
    - xlit/\{\}/\âŸ¨\âŸ©/
  tags: [ abc, rev_moran ]

# æ‹†åˆ†ç·¨ç¢¼æç¤º
division.lv2:
  __include: rev_div
  option_name: division.lv2
  comment_format:
    - xform/\(([^,]*),([^,]*),([^,]*),([^,]*)\)/($2)/
    - xform/.*\(([^()]*)\)$/($1)/
  tags: [ abc, rev_moran ]

# è®€éŸ³æç¤º
division.lv3:
  __include: rev_div
  option_name: division.lv3
  comment_format:
    - xform/\(([^,]*),([^,]*),([^,]*),([^,]*)\)/($3)/
    - xform/.*\(([^()]*)\)$/($1)/
    - xlit/_/,/
  tags: [ abc, rev_moran ]

# å­—é›†æç¤º
division.lv4:
  __include: rev_div
  option_name: division.lv4
  comment_format:
    - xform/\(([^,]*),([^,]*),([^,]*),([^,]*)\)/($4)/
    - xform/.*\(([^()]*)\)$/($1)/
  tags: [ abc, rev_moran ]

# éƒ¨ä»¶æ‹†åˆ†åŠç·¨ç¢¼æç¤º, åæŸ¥æ—¶é¡¯ç¤º
rev_div:
  option_name: division.off
  opencc_config: liuli_div.json
  tips: all
  show_in_comment: true
  comment_format:
    - xform/\(([^,]*),([^,]*),([^,]*),([^,]*)\)/($1Â·$2)/
    - xlit/\{\}/\âŸ¨\âŸ©/
  tags: [ rev_moran ]

# æ‹¼éŸ³åæŸ¥
rev_moran:
  tag: rev_moran
  prefix: "`"
  dictionary: liuli.moran
  preedit_format:
    - xform/^`//
  comment_format:
    - "xform/^/(/"
    - "xform/$/)/"

emoji:
  opencc_config: emoji.json
  option_name: emoji
  tips: all

ivd_map:
  option_name: ivd_map
  opencc_config: moji_map.json
  tags: [ grave ]

# ç¬¦è™Ÿç¿»è­¯å™¨
symbols:
  tag: symbols
  prefix: "/"
  dictionary: liuli.symbols
  prism: liuli.symbols
  enable_user_dict: false
  preedit_format:
    - xform|^/||

ll:
  funckeys:
    # under linux, cat /usr/include/X11/keysymdef.h
    # or visit: https://gitlab.freedesktop.org/xorg/proto/xorgproto/-/blob/master/include/X11/keysymdef.h
    # frequently used:
    # - functional keys: escape: 0xff1b; return: 0xff0d; tabular: 0xff09; CapsLock: 0xffe5;
    #define XK_BackSpace                     0xff08  /* U+0008 BACKSPACE */
    #define XK_Tab                           0xff09  /* U+0009 CHARACTER TABULATION */
    #define XK_Linefeed                      0xff0a  /* U+000A LINE FEED */
    #define XK_Clear                         0xff0b  /* U+000B LINE TABULATION */
    #define XK_Return                        0xff0d  /* U+000D CARRIAGE RETURN */
    #define XK_Pause                         0xff13  /* Pause, hold */
    #define XK_Scroll_Lock                   0xff14
    #define XK_Sys_Req                       0xff15
    #define XK_Escape                        0xff1b  /* U+001B ESCAPE */
    #define XK_Delete                        0xffff  /* U+007F DELETE */
    #define XK_Shift_L                       0xffe1  /* Left shift */
    #define XK_Shift_R                       0xffe2  /* Right shift */
    #define XK_Control_L                     0xffe3  /* Left control */
    #define XK_Control_R                     0xffe4  /* Right control */
    #define XK_Caps_Lock                     0xffe5  /* Caps lock */
    #define XK_Shift_Lock                    0xffe6  /* Shift lock */
    #define XK_Meta_L                        0xffe7  /* Left meta */
    #define XK_Meta_R                        0xffe8  /* Right meta */
    #define XK_Alt_L                         0xffe9  /* Left alt */
    #define XK_Alt_R                         0xffea  /* Right alt */
    #define XK_Super_L                       0xffeb  /* Left super */
    #define XK_Super_R                       0xffec  /* Right super */
    #define XK_Hyper_L                       0xffed  /* Left hyper */
    #define XK_Hyper_R                       0xffee  /* Right hyper */
    # - ascii characters: space: 0x20; semicolon: 0x3b; slash: 0x2f; grave: 0x60; ': 0x27; [: 0x5b; ]: 0x5d;
    macro: [ 0x2f ]      # ä»¥é€™äº›å­—ç¬¦é–‹é ­, å‰‡èªçˆ²æ˜¯å®èª¿ç”¨
    primary: [ 0x20 ]    # é¦–è¦ç°¡ç¢¼éµ
    secondary: [ 0x3b ]  # æ¬¡è¦ç°¡ç¢¼éµ
    tertiary: [ 0x27 ]   # æ¬¡æ¬¡ç°¡ç¢¼éµ
    fullci: [ 0xff09 ]   # ç¢¼é•·çˆ²å››æ™‚, è¼¸å…¥æ­¤ä¸²ä¸Šå±é¦–é¸
    break: [ 0xff09 ]    # æ‰“æ–·æ–½æ³•
    repeat: [ 0x60 ]     # é‡è¤‡ä¸Šå±
    clearact: [ 0xff0d, 0xff1b ] # æ¸…é™¤æ´»å‹•ç·¨ç¢¼
  mappers:
    # å¸¸ç”¨å­—éæ¿¾å™¨
    - option_name: charset.freqly
      expr: return require("liuli.custom").freq_filter()
  macros:
    help:
      - { type: tip, name: â–é…ç½®ä¸­å¿ƒ }
      - { type: radio, names: [ hwang, sentence, single_char_delay, single_char ], states: [ â– æ™ºèƒ½å»¶è¿Ÿé¡¶, â–¡æ•´å¥, â–¡äº”ä¸‰é¡¶, â–¡ä¸‰å®š ] }
      - { type: radio, names: [ full.word, full.char, full.off ], states: [ â˜‘â˜‘å­—è¯åŒå‡º, â˜â˜‘ç¦å‡ºè¯ç»„, â˜â˜ç¦å‡ºå››ç  ] }
      - { type: switch, name: embeded_cands, states: [ â˜åµŒå…¥, â˜‘åµŒå…¥ ] }
      - { type: switch, name: completion, states: [ â–¡ç®€æ´, â– è¡¥å…¨ ] }
      - { type: radio, names: [ division.off, division.lv1, division.lv2, division.lv3, division.lv4 ], states: [ â˜â˜â˜â˜æ³¨è§£, â˜‘â˜â˜â˜æ³¨è§£, â˜â˜‘â˜â˜æ³¨è§£, â˜â˜â˜‘â˜æ³¨è§£, â˜â˜â˜â˜‘æ³¨è§£ ] }
    date:
      - { type: eval, name: â˜€æ—¥æœŸ, expr: return os.date("%Y%m%d") }
      - { type: eval, name: â˜€æ—¥æœŸ(åˆ†éš”), expr: return os.date("%Y-%m-%d") }
      - { type: eval, name: â›…å¹´æœˆæ—¥, expr: return os.date("%Yå¹´%mæœˆ%dæ—¥") }
    time:
      - { type: eval, name: â“‰æ—¶é—´, expr: return os.date("%Y%m%d%H%M") }
      - { type: eval, name: âŒšæ—¶é—´(åˆ†éš”), expr: return os.date("%H:%M:%S") }
      - { type: eval, name: â°æ—¶åˆ†ç§’, expr: return os.date("%Hæ—¶%Måˆ†%Sç§’") }
      - { type: eval, name: â“ˆæ—¶é—´æˆ³, expr: return tostring(os.time()) }
    div:
      - type: radio
        names: [ division.off, division.lv1, division.lv2, division.lv3, division.lv4 ]
        states: [ â˜â˜â˜â˜æ— æ³¨è§£, â˜‘â˜â˜â˜æ‹†åˆ†æç¤º, â˜â˜‘â˜â˜ç¼–ç æç¤º, â˜â˜â˜‘â˜æ˜¾ç¤ºæ‹¼éŸ³, â˜â˜â˜â˜‘æ˜¾ç¤ºå­—é›† ]
    embed:
      - { type: switch, name: embeded_cands, states: [ â˜åµŒå…¥ç¼–ç , â˜‘åµŒå…¥å€™é€‰ ] }
    full:
      - type: radio
        names: [ full.word, full.char, full.off ]
        states: [ "â˜‘â˜‘å­—è¯åŒå‡º: æ˜¾ç¤ºæ‰€æœ‰å€™é€‰", "â˜â˜‘ç¦å‡ºè¯ç»„: éšè—è¯è¯­å€™é€‰", "â˜â˜ç¦å‡ºå››ç : éšè—å››ç å€™é€‰" ]
    smart:
      - { type: radio, names: [ hwang, sentence, single_char_delay, single_char ], states: [ â– æ™ºèƒ½å»¶è¿Ÿé¡¶, â–¡æ•´å¥, â–¡äº”ä¸‰é¡¶, â–¡ä¸‰å®š ] }
    comp:
      - type: switch
        name: completion
        states: [ "â–¡ç®€æ´æ¨¡å¼: ä¸æ˜¾ç¤ºç¼–ç é¢„æµ‹ç»“æœ", "â– è‡ªåŠ¨è¡¥å…¨: æ˜¾ç¤ºç¼–ç é¢„æµ‹ç»“æœ" ]
    charset:
      - type: radio
        names: [ charset.all, charset.freqly ]
        states: [ "â–¡å…¨CJKå­—é›†: æ— è¿‡æ»¤", "â– å¸¸ç”¨å­—é›†: è¿‡æ»¤éå¸¸ç”¨å­—" ]
    emo:
      - type: switch
        name: emoji
        states: [ "Emoji: åœç”¨", "Emoji: å¯ç”¨" ]
    ivd:
      - type: switch
        name: ivd_map
        states: [ "å¼‚å­—é€‰æ‹©å™¨: åœç”¨", "å¼‚ä½“å­—é€‰æ‹©å™¨: å¯ç”¨" ]

# åµŒå…¥å€™é¸çš„é¡¯ç¤ºé…ç½®
# é»˜èªé¡¯ç¤ºæ•ˆæœçˆ²:
# ğŸ’ ç‰ Â»ç’ƒÂ« [kmt] ~ç¯±Â² ~ç±“Â³
embeded_cands:
  index_indicators: [ Â¹, Â², Â³, â´, âµ, â¶, â·, â¸, â¹, â° ]       # åµŒå…¥å€™é¸çš„åºè™Ÿé¡¯ç¤ºæ ¼å¼
  first_format: "${Stash}[${å€™é¸}${Seq}]${Code}${Comment}" # é¦–é¸çš„æ¸²æŸ“æ ¼å¼
  next_format: "${Stash}${å€™é¸}${Seq}${Comment}"           # éé¦–é¸çš„æ¸²æŸ“æ ¼å¼
  separator: " "                                           # å€™é¸ä¹‹é–“çš„åˆ†éš”ç¬¦
  stash_placeholder: "~"                                   # éé¦–é¸çš„å»¶é²ä¸²å ä½ç¬¦, æ”¯æŒ ${Stash} è®Šé‡

# æ ‡ç‚¹
punctuator:
  import_preset: symbols
  symbols:
    __append:
      '/tab' : '	' #åˆ¶è¡¨ç¬¦

key_binder:
  bindings:
    # ç©ºæ ¼æ¸…ç©ºé”™ç 
    - { when: has_menu, accept: space, send: space }
    - { when: composing, accept: space, send: Escape }
    # å‡å·ã€ç­‰å·ç¿»é¡µ
    - { when: paging, accept: minus, send: Page_Up }
    - { when: has_menu, accept: equal, send: Page_Down }
    # é€‰é‡
    - {when: has_menu, accept: semicolon, send: 2}
    - {when: has_menu, accept: apostrophe, send: 3}
    - { when: has_menu, accept: 9, send: 2 }
    - { when: has_menu, accept: 8, send: 3 }
    - { when: has_menu, accept: 7, send: 4 }
    - { when: has_menu, accept: 6, send: 5 }
    # æ‹†åˆ†æç¤º
    - { when: has_menu, accept: "Control+Shift+C", toggle: division.off }
    - { when: has_menu, accept: "/", toggle: division.off }
    # å­—é›†åˆ‡æ›
    - { when: has_menu, accept: "0", toggle: charset.all }
    # å†…åµŒå€™é¸é–‹é—œ
    - { when: always, accept: "Control+Shift+E", toggle: embeded_cands }
    # ä¸­è‹±æ–‡æ ‡ç‚¹
    - {when: always, accept: Control+period, toggle: ascii_punct}

recognizer:
  patterns:
    # ç‰¹æ®Šç¬¦è™Ÿ
    symbols: "^/([0-9]0?|[A-Za-z]+)$"
    # æ‹¼éŸ³åæŸ¥æ¨¡å¼
    rev_moran: "^`[a-z]+$"
    # å–®ç¨åå¼•è™Ÿ
    grave: "^`$"

menu:
  page_size: 3
